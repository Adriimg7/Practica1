<body>
  <header>
    <h1>Tecnologías y Sistemas Web 24/25</h1>
    <h2>Carrito de compra</h2>
  </header>
  <article>
    <nav class="navbar">
      <ul>
        <li><a id="homeLink" href="cliente-home.html">Inicio</a></li>
        <li><a id="carroLink" href="cliente-carro.html">Carro</a></li>
        <li><a id="facturasLink" href="cliente-facturas.html">Facturas</a></li>
        <li><a id="perfilLink" href="cliente-perfil.html">Perfil</a></li>
        <li><a id="salirLink" href="home.html" onclick="console.log('Funciona?')">Salir</a></li>
      </ul>
    </nav>
    <div class="contenido">
      <div class="info">
        <!-- Contenedor de mensajes -->
        <div class="mensajes-container" id="mensajesContainer"></div>
        <!-- Tabla de libros en el carrito -->
        <div id="catalogo" class="catalogo">
          <h2>Carrito de compras</h2>
          <table>
            <thead>
              <tr>
                <th scope="col">Título</th>
                <th scope="col">Cantidad</th>
                <th scope="col">Precio Unitario</th>
                <th scope="col">Total</th>
              </tr>
            </thead>
            <tbody id="lista-libros">
              <!-- Aquí se renderizarán los libros del carrito -->
            </tbody>
          </table>
          <!-- Resumen de totales -->
          <div id="total">
            <!-- <p>Subtotal: <span id="subtotal"></span></p>
              <p>IVA: <span id="iva"></span></p>
              <p>Total: <span id="total-final"></span></p> -->

            <p>Subtotal: €<span id="subtotal">0.00</span></p>
            <p>IVA: €<span id="iva">0.00</span></p>
            <p>Total: €<span id="total-final">0.00</span></p>
          </div>
          <!-- Botón de compra -->
          <!--<button id="boton-comprar" href="cliente-comprar-carro.html">Comprar</button>-->
          <button id="boton-comprar" onclick="location.href='cliente-comprar-carro.html'">Comprar</button>
        </div>
      </div>
      <footer>
        Prof. Dr. Ricardo Tesoriero Pszytula<br>
        Tecnologías y Sistemas Web 24/25<br>
        Universidad de Castilla-La Mancha<br>
        <small>20 de septiembre de 2021</small>
      </footer>
    </div>
  </article>

  <!-- Script para inicializar y mostrar el carrito -->
  <script type="module">
    import { ClienteCarroPresenter } from './ClienteCarroPresenter.mjs';
    import { model } from './model/model.mjs';

    window.presenter = newClienteCarroPresenter(model, "cliente-carro");

    document.addEventListener("DOMContentLoaded", () => {
      //const presenter = new ClienteCarroPresenter(model, "cliente-carro");

      // Muestra el contenido del carrito al cargar la página
      presenter.mostrarCarrito();

      // Agrega funcionalidad al botón "Comprar"
      document.querySelector("#boton-comprar").addEventListener("click", () => {
        alert("Compra realizada con éxito");
        model.getClienteActual().getCarro().removeItems();  // Vacía el carrito
        presenter.mostrarCarrito(); // Actualiza la vista del carrito
      });
    });
  </script>
</body>